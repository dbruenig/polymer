<!doctype html>
<html>
<head>

  <title>x-repeat</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../polymer.html">
  <link rel="import" href="../../../layout/layout.html">

</head>
<body>

<style>
  body {
    font-family: sans-serif;
    font-size: 14px;
  }
</style>

<dom-module id="x-labeled-input">
  <style>
    :host {
      width: 400px
    }
    #label {
      width: 200px;
      overflow: hidden;
      border-bottom: 1px solid gray;
      border-bottom-style: dashed;
    }
    input {
      margin-right: 5px;
    }
  </style>
  <template>
    <div class="layout horizontal">
      <span id="label" class="flex">{{label}}</span>
      <input value="{{value::input}}">
    </div>
  </template>
</dom-module>


<dom-module id="x-test">
  <style>
    .outer {
      padding: 10px;
    }
    .column {
      width: 400px;
      overflow: auto;
    }
    .item {
      margin: 5px;
      margin-left: 10px;
      margin-right: 0;
      padding: 5px;
      padding-right: 0;
      background-color: rgba(0,0,0,0.1);
    }
    .index {
      display: inline-block;
      background-color: gray;
      color: white;
      padding: 4px;
      margin-bottom: 4px;
      border-radius: 4px;
    }
  </style>
  <template>

    <div class="fit layout vertical">

      <div class="outer">
        <div class="index">Outer scope:</div>
        <x-labeled-input label="outer1" value="{{outer1}}"></x-labeled-input>
        <x-labeled-input label="outer2" value="{{outer2}}"></x-labeled-input>
        <x-labeled-input label="outer3" value="{{outer3}}"></x-labeled-input>
        <x-labeled-input label="outerObj1.value" value="{{outerObj1.value}}"></x-labeled-input>
        <x-labeled-input label="outerObj2.value" value="{{outerObj2.value}}"></x-labeled-input>
        <x-labeled-input label="outerObj3.value" value="{{outerObj3.value}}"></x-labeled-input>
      </div>

      <div class="layout horizontal flex">

        <div class="column flex">
          <template is="x-repeat" id="xr1-1" idx$="{{index}}" items="{{items}}">
            <div class="item">
              <div class="index">idx: <span>{{index}}</span></div>
              <x-labeled-input label="item.name" value="{{item.name}}"></x-labeled-input>
              <x-labeled-input label="parent.outer1" value="{{parent.outer1}}"></x-labeled-input>
              <x-labeled-input label="parent.outerObj1.value" value="{{parent.outerObj1.value}}"></x-labeled-input>
              <template is="x-repeat" id="xr1-2" idx$="{{index}}" items="{{item.items}}">
                <div class="item">
                  <div class="index">idx: <span>{{index}}</span></div>
                  <x-labeled-input label="item.name" value="{{item.name}}"></x-labeled-input>
                  <x-labeled-input label="parent.parent.outer2" value="{{parent.parent.outer2}}"></x-labeled-input>
                  <x-labeled-input label="parent.parent.outerObj2.value" value="{{parent.parent.outerObj2.value}}"></x-labeled-input>
                  <template is="x-repeat" id="xr1-3" idx$="{{index}}" items="{{item.items}}">
                    <div class="item">
                      <div class="index">idx: <span>{{index}}</span></div>
                      <x-labeled-input label="item.name" value="{{item.name}}"></x-labeled-input>
                      <x-labeled-input label="parent.parent.parent.outer3" value="{{parent.parent.parent.outer3}}"></x-labeled-input>
                      <x-labeled-input label="parent.parent.parent.outerObj3.value" value="{{parent.parent.parent.outerObj3.value}}"></x-labeled-input>
                    </div>
                  </template>
                </div>
              </template>
            </div>
          </template>
        </div>

        <div class="column flex">
          <template is="x-repeat" id="xr2-1" idx$="{{index}}" items="{{items}}">
            <div class="item">
              <div class="index">idx: <span>{{index}}</span></div>
              <x-labeled-input label="item.name" value="{{item.name}}"></x-labeled-input>
              <x-labeled-input label="parent.outer1" value="{{parent.outer1}}"></x-labeled-input>
              <x-labeled-input label="parent.outerObj1.value" value="{{parent.outerObj1.value}}"></x-labeled-input>
              <template is="x-repeat" id="xr2-2" idx$="{{index}}" items="{{item.items}}">
                <div class="item">
                  <div class="index">idx: <span>{{index}}</span></div>
                  <x-labeled-input label="item.name" value="{{item.name}}"></x-labeled-input>
                  <x-labeled-input label="parent.parent.outer2" value="{{parent.parent.outer2}}"></x-labeled-input>
                  <x-labeled-input label="parent.parent.outerObj2.value" value="{{parent.parent.outerObj2.value}}"></x-labeled-input>
                  <template is="x-repeat" id="xr2-3" idx$="{{index}}" items="{{item.items}}">
                    <div class="item">
                      <div class="index">idx: <span>{{index}}</span></div>
                      <x-labeled-input label="item.name" value="{{item.name}}"></x-labeled-input>
                      <x-labeled-input label="parent.parent.parent.outer3" value="{{parent.parent.parent.outer3}}"></x-labeled-input>
                      <x-labeled-input label="parent.parent.parent.outerObj3.value" value="{{parent.parent.parent.outerObj3.value}}"></x-labeled-input>
                    </div>
                  </template>
                </div>
              </template>
            </div>
          </template>
        </div>

      </div>

    </div>

  </template>
</dom-module>

<script>
  HTMLImports.whenReady(function() {

    Polymer ({
      is: 'x-labeled-input',
      properties: {
        value: {
          notify: true
        },
        label: String
      }
    });

    Polymer ({
      is: 'x-test',
      properties: {
        items: {
          value: function() {
            return [
              {name: 'item 1', items: [
                {name: 'item 1-1', items: [
                  {name: 'item 1-1-1'},
                  {name: 'item 1-1-2'},
                  {name: 'item 1-1-3'}
                ]},
                {name: 'item 1-2', items: [
                  {name: 'item 1-2-1'},
                  {name: 'item 1-2-2'},
                  {name: 'item 1-2-3'}
                ]},
                {name: 'item 1-3', items: [
                  {name: 'item 1-3-1'},
                  {name: 'item 1-3-2'},
                  {name: 'item 1-3-3'}
                ]}
              ]},
              {name: 'item 2', items: [
                {name: 'item 2-1', items: [
                  {name: 'item 2-1-1'},
                  {name: 'item 2-1-2'},
                  {name: 'item 2-1-3'}
                ]},
                {name: 'item 2-2', items: [
                  {name: 'item 2-2-1'},
                  {name: 'item 2-2-2'},
                  {name: 'item 2-2-3'}
                ]},
                {name: 'item 2-3', items: [
                  {name: 'item 2-3-1'},
                  {name: 'item 2-3-2'},
                  {name: 'item 2-3-3'}
                ]}
              ]},
              {name: 'item 3', items: [
                {name: 'item 3-1', items: [
                  {name: 'item 3-1-1'},
                  {name: 'item 3-1-2'},
                  {name: 'item 3-1-3'}
                ]},
                {name: 'item 3-2', items: [
                  {name: 'item 3-2-1'},
                  {name: 'item 3-2-2'},
                  {name: 'item 3-2-3'}
                ]},
                {name: 'item 3-3', items: [
                  {name: 'item 3-3-1'},
                  {name: 'item 3-3-2'},
                  {name: 'item 3-3-3'}
                ]},
              ]}
            ];
          }
        },
        outer1: {
          value: 'outer1'
        },
        outer2: {
          value: 'outer2'
        },
        outer3: {
          value: 'outer3'
        },
        outerObj1: {
          value: function() { return { value: 'outerObj1.value' }; }
        },
        outerObj2: {
          value: function() { return { value: 'outerObj2.value' }; }
        },
        outerObj3: {
          value: function() { return { value: 'outerObj3.value' }; }
        }
      }
    });

  });
</script>

<x-test class="fit"></x-test>